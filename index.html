<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>כותב +AI - עוזר כתיבת החיבורים שלך</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            direction: rtl;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            color: white;
            padding: 40px 0;
        }

        .header h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.3em;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .main-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .homepage {
            text-align: center;
        }

        .homepage h2 {
            color: #2c3e50;
            font-size: 2.2em;
            margin-bottom: 20px;
        }

        .homepage .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
            margin-bottom: 50px;
            line-height: 1.6;
        }

        .essay-type-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 40px;
            margin-top: 40px;
        }

        .essay-type-box {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
            border: 3px solid #e9ecef;
            border-radius: 25px;
            padding: 50px 30px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .essay-type-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1;
        }

        .essay-type-box > * {
            position: relative;
            z-index: 2;
        }

        .essay-type-box:hover {
            transform: translateY(-15px) scale(1.05);
            box-shadow: 0 25px 50px rgba(102, 126, 234, 0.4);
            border-color: #667eea;
        }

        .essay-type-box:hover::before {
            opacity: 1;
        }

        .essay-type-box:hover h3,
        .essay-type-box:hover p {
            color: white;
        }

        .essay-type-box .emoji {
            font-size: 4em;
            margin-bottom: 20px;
            display: block;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1));
        }

        .essay-type-box h3 {
            font-size: 1.8em;
            margin-bottom: 20px;
            transition: color 0.3s ease;
            color: #2c3e50;
            font-weight: bold;
        }

        .essay-type-box p {
            color: #6c757d;
            font-size: 1.1em;
            line-height: 1.6;
            transition: color 0.3s ease;
        }

        .step-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .step-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .progress-indicator {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.3em;
            color: #667eea;
            font-weight: bold;
        }

        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }

        .back-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-right: 5px solid #667eea;
        }

        .card h3 {
            color: #333;
            margin-bottom: 25px;
            font-size: 1.6em;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #555;
            font-size: 1.1em;
        }

        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            font-family: inherit;
            resize: vertical;
        }

        .input-group input:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .textarea-large {
            min-height: 120px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .tips-box {
            background: linear-gradient(45deg, #e3f2fd, #bbdefb);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid #2196f3;
        }

        .tips-box h4 {
            color: #1565c0;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5em;
        }

        .tip-section {
            background: rgba(255, 255, 255, 0.8);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .tip-section h5 {
            color: #0d47a1;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .tip-section ul {
            padding-right: 25px;
            margin-bottom: 15px;
        }

        .tip-section li {
            margin-bottom: 10px;
            line-height: 1.6;
            font-size: 1.05em;
        }

        .example-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            font-style: italic;
            color: #495057;
        }

        .success-message {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
            text-align: center;
        }

        .error-message {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
            text-align: center;
        }

        .chatgpt-redirect {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .chatgpt-redirect h4 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .chatgpt-redirect p {
            color: #856404;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .btn-chatgpt {
            background: linear-gradient(45deg, #10a37f, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(16, 163, 127, 0.3);
        }

        .btn-chatgpt:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 163, 127, 0.4);
            color: white;
            text-decoration: none;
        }

        .word-error {
            background: #fff5f5;
            border: 2px solid #dc3545;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .word-error .error-word {
            color: #dc3545;
            font-weight: bold;
            font-size: 16px;
        }

        .word-error .suggestion {
            color: #28a745;
            font-weight: bold;
            font-size: 16px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2.5em;
            }
            
            .main-content {
                padding: 30px 20px;
            }
            
            .essay-type-grid {
                grid-template-columns: 1fr;
                gap: 25px;
            }

            .essay-type-box .emoji {
                font-size: 3em;
            }

            .essay-type-box h3 {
                font-size: 1.5em;
            }

            .essay-type-box {
                min-height: 250px;
                padding: 40px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>כותב +AI ✍️</h1>
            <p>העוזר החכם שלך לכתיבת חיבורים מעולים!</p>
        </div>

        <div class="main-content">
            <!-- דף השער -->
            <div class="step-content active" id="homepage">
                <div class="homepage">
                    <h2>בחר את סוג החיבור שברצונך לכתוב</h2>
                    <p class="subtitle">לחץ על אחת מהאפשרויות כדי להתחיל בתכנון החיבור שלך</p>
                    
                    <div class="essay-type-grid">
                        <div class="essay-type-box" onclick="selectEssayType('argumentative')">
                            <div class="emoji">⚖️</div>
                            <h3>חיבור טיעוני</h3>
                            <p>הצגת עמדה עם טיעונים חזקים, התייחסות לטענת נגד והפרכתה. מתאים לנושאים שנויים במחלוקת.</p>
                        </div>
                        
                        <div class="essay-type-box" onclick="selectEssayType('descriptive')">
                            <div class="emoji">🎨</div>
                            <h3>כתיבה יצירתית</h3>
                            <p>יצירת סיפור, תיאור חוויה או זיכרון באופן יצירתי ומעניין. כולל בניית דמויות ועלילה.</p>
                        </div>
                        
                        <div class="essay-type-box" onclick="selectEssayType('formal_letter')">
                            <div class="emoji">📋</div>
                            <h3>מכתב רשמי</h3>
                            <p>כתיבת מכתב למוסד, בית ספר או גורם רשמי. כולל מבנה נכון ושפה מתאימה.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- חיבור טיעוני -->
            <div class="step-content" id="argumentative">
                <div class="progress-indicator">תכנון חיבור טיעוני ⚖️</div>
                
                <button class="back-btn" onclick="goBack()">← חזרה לבחירת סוג חיבור</button>
                
                <div class="card">
                    <h3>תכנון החיבור הטיעוני שלך 🎯</h3>
                    
                    <div class="input-group">
                        <label for="argTopic">מה הנושא של החיבור?</label>
                        <input type="text" id="argTopic" placeholder="למשל: השפעת הטכנולוגיה על החברה המודרנית">
                    </div>

                    <div class="input-group">
                        <label for="argPosition">מה הטענה שלך?</label>
                        <textarea id="argPosition" class="textarea-large" placeholder="הצג בבירור מה הטענה שלך בנושא..."></textarea>
                    </div>

                    <div class="input-group">
                        <label for="argArguments">3 טיעונים עיקריים התומכים בטענה שלך:</label>
                        <textarea id="argArguments" class="textarea-large" placeholder="טיעון 1: ...&#10;טיעון 2: ...&#10;טיעון 3: ..."></textarea>
                    </div>

                    <div class="input-group">
                        <label for="argCounterArgument">טענת הנגד:</label>
                        <textarea id="argCounterArgument" class="textarea-large" placeholder="יש הטוענים כי..."></textarea>
                    </div>

                    <div class="input-group">
                        <label for="argRefutation">ההפרכה שלך לטענת הנגד:</label>
                        <textarea id="argRefutation" class="textarea-large" placeholder="אולם טענה זו שגויה מכיוון ש..."></textarea>
                    </div>

                    <div class="input-group">
                        <label for="argSummary">סיכום והמלצה:</label>
                        <textarea id="argSummary" class="textarea-large" placeholder="סכם את טענתך וכתוב המלצה..."></textarea>
                    </div>

                    <div style="text-align: center; margin: 30px 0;">
                        <button class="btn-primary" onclick="checkSpellingBeforeOutline('argumentative')" style="background: #17a2b8; margin-left: 10px;">🔍 בדוק שגיאות כתיב</button>
                        <button class="btn-primary" onclick="generateOutline('argumentative')">צור מתווה לחיבור 🚀</button>
                    </div>
                    <div id="argOutline"></div>
                </div>

                <div class="tips-box">
                    <h4>🎯 טיפים לחיבור טיעוני מוצלח</h4>
                    
                    <div class="tip-section">
                        <h5>🏗️ מבנה חזק</h5>
                        <ul>
                            <li>פתיחה: הצג את הנושא ואת העמדה שלך בבירור</li>
                            <li>גוף החיבור יכלול: 4 עד 6 פסקאות, כל פסקה תכלול דוגמה/הוכחה</li>
                            <li>התייחסות לעמדה נגדית והפרכה שלה</li>
                            <li>מסקנה: סיכום הטענה שלך ומסקנה</li>
                        </ul>
                        <div class="example-box">
                            <strong>דוגמה לפתיחה:</strong> "בשנים האחרונות חלה עלייה בשימוש בכלי הבינה המלאכותית ליצירת חיבורים."
                        </div>
                    </div>

                    <div class="tip-section">
                        <h5>💪 טיפים מעשיים</h5>
                        <ul>
                            <li>השתמש בדוגמאות קונקרטיות ומקורות אמינים</li>
                            <li>כל פסקה תתיחס להיבט שונה</li>
                            <li>מילות קישור: "ראשית", "שנית", "יתרה מכך", "לכן"</li>
                            <li>זכור שאתה צריך להתיחס לטענת הנגד ולהפריך אותה</li>
                        </ul>
                        <div class="example-box">
                            <strong>דוגמה למעבר מפסקה לפסקה:</strong> "בנוסף לכך, חשוב לציין כי..." או "מצד שני, יש לזכור ש..."
                        </div>
                    </div>
                </div>
            </div>

            <!-- כתיבה יצירתית -->
            <div class="step-content" id="descriptive">
                <div class="progress-indicator">תכנון כתיבה יצירתית 🎨</div>
                
                <button class="back-btn" onclick="goBack()">← חזרה לבחירת סוג חיבור</button>
                
                <div class="card">
                    <h3>תכנון הכתיבה היצירתית שלך 🎨</h3>
                    
                    <div class="input-group">
                        <label for="descTopic">רעיון ראשוני - על מה תרצה לכתוב?</label>
                        <input type="text" id="descTopic" placeholder="למשל: סיפור, זכרון ילדות, דמיון, סיטואציה">
                    </div>

                    <div class="input-group">
                        <label for="descMainImpression">אפיון דמויות ומקום</label>
                        <textarea id="descMainImpression" class="textarea-large" placeholder="מיהן הדמויות הראשיות? היכן מתרחש הסיפור? באיזה תקופה? איך הדמויות מרגישות?"></textarea>
                    </div>

                    <div class="input-group">
                        <label for="descAspects">בניית עלילה:</label>
                        <textarea id="descAspects" class="textarea-large" placeholder="פתיחה, בעיה/קונפליקט, שיא, פתרון, סיום..."></textarea>
                    </div>

                    <div class="input-group">
                        <label for="descSenses">כתיבה סגנונית:</label>
                        <textarea id="descSenses" class="textarea-large" placeholder="שימוש במטאפורות, דימויים, שאלות ריטוריות, כתיב בגוף ראשון/שלישי, כתיבה חושית: מה שומעים? רואים? מריחים? מרגישים? שילוב מונולוג פנימי או דיאלוגים..."></textarea>
                    </div>

                    <div style="text-align: center; margin: 30px 0;">
                        <button class="btn-primary" onclick="checkSpellingBeforeOutline('descriptive')" style="background: #17a2b8; margin-left: 10px;">🔍 בדוק שגיאות כתיב</button>
                        <button class="btn-primary" onclick="generateOutline('descriptive')">צור מתווה לחיבור 🚀</button>
                    </div>
                    <div id="descOutline"></div>
                </div>

                <div class="tips-box">
                    <h4>🎨 טיפים לכתיבה יצירתית מוצלחת</h4>
                    
                    <div class="tip-section">
                        <h5>🌟 עקרונות בסיסיים</h5>
                        <ul>
                            <li>לכתוב פתיחה מסקרנת</li>
                            <li>לבנות עלילה ברורה</li>
                            <li>להתחיל מרגש חזק</li>
                            <li>להפעיל את החושים</li>
                            <li>להשתמש בשפה עשירה ומגוונת</li>
                            <li>לשלב דיאלוגים ומונולוג פנימי</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- מכתב רשמי -->
            <div class="step-content" id="formal_letter">
                <div class="progress-indicator">תכנון מכתב רשמי 📋</div>
                
                <button class="back-btn" onclick="goBack()">← חזרה לבחירת סוג חיבור</button>
                
                <div class="card">
                    <h3>תכנון המכתב הרשמי שלך 📋</h3>
                    
                    <div class="input-group">
                        <label for="formalPurpose">מה המטרה של המכתב?</label>
                        <input type="text" id="formalPurpose" placeholder="למשל: בקשה לדחיית בחינה, תלונה על שירות, בקשה למלגה, כתיבת המלצה">
                    </div>

                    <div class="input-group">
                        <label for="formalRecipient">למי אתה פונה?</label>
                        <input type="text" id="formalRecipient" placeholder="למשל: מנהל בית הספר, מחלקת שירות לקוחות, ועדת מלגות">
                    </div>

                    <div class="input-group">
                        <label for="formalMainPoints">נקודות עיקריות שברצונך להעביר:</label>
                        <textarea id="formalMainPoints" class="textarea-large" placeholder="נקודה 1: הבעיה או הבקשה...&#10;נקודה 2: הסיבות והנסיבות...&#10;נקודה 3: מה אתה מבקש לקבל..."></textarea>
                    </div>

                    <div class="input-group">
                        <label for="formalDetails">פרטים רלוונטיים (תאריכים, מספרי אסמכתא וכו'):</label>
                        <textarea id="formalDetails" class="textarea-large" placeholder="רשום פרטים חשובים שצריך לכלול במכתב..."></textarea>
                    </div>

                    <div style="text-align: center; margin: 30px 0;">
                        <button class="btn-primary" onclick="checkSpellingBeforeOutline('formal_letter')" style="background: #17a2b8; margin-left: 10px;">🔍 בדוק שגיאות כתיב</button>
                        <button class="btn-primary" onclick="generateOutline('formal_letter')">צור מתווה למכתב 🚀</button>
                    </div>
                    <div id="formalOutline"></div>
                </div>

                <div class="tips-box">
                    <h4>📋 טיפים למכתב רשמי מוצלח</h4>
                    
                    <div class="tip-section">
                        <h5>🏗️ מבנה נדרש</h5>
                        <ul>
                            <li>כתובת השולח ותאריך (בראש המכתב)</li>
                            <li>כתובת הנמען ונושא המכתב</li>
                            <li>פנייה מנומסת ("אדון/גברת נכבד/ה")</li>
                            <li>גוף המכתב - הבהרת המטרה ופירוט הבקשה</li>
                            <li>סיום מנומס וחתימה</li>
                        </ul>
                        <div class="example-box">
                            <strong>דוגמה לפתיחה:</strong> "הנדון: בקשה לדחיית מועד בחינה<br>אדון/גברת נכבד/ה,<br>אני פונה אליכם בעניין בקשה לדחיית מועד בחינה..."
                        </div>
                    </div>

                    <div class="tip-section">
                        <h5>💼 שפה וסגנון</h5>
                        <ul>
                            <li>השתמש בשפה רשמית</li>
                            <li>הבהר את המטרה כבר בפסקה הראשונה</li>
                            <li>היה ברור ומדויק בבקשתך</li>
                        </ul>
                        <div class="example-box">
                            <strong>ביטויים מועילים:</strong> "אני פונה אליכם בעניין...", "אודה לקבל מענה בהקדם", "בכבוד רב", "בתודה מראש"
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // פונקציות בסיסיות
        function selectEssayType(type) {
            console.log('selectEssayType נקראה עם:', type);
            
            document.querySelectorAll('.step-content').forEach(step => {
                step.classList.remove('active');
            });
            
            const targetStep = document.getElementById(type);
            if (targetStep) {
                targetStep.classList.add('active');
                console.log('עבר לדף:', type);
                window.scrollTo(0, 0);
            } else {
                console.error('לא נמצא אלמנט עם ID:', type);
            }
        }

        function goBack() {
            console.log('goBack נקראה');
            
            document.querySelectorAll('.step-content').forEach(step => {
                step.classList.remove('active');
            });
            
            document.querySelectorAll('input, textarea').forEach(input => {
                input.value = '';
                input.style.borderColor = '';
                input.style.backgroundColor = '';
            });
            
            document.querySelectorAll('#argOutline, #descOutline, #formalOutline').forEach(outline => {
                outline.innerHTML = '';
            });
            
            const existingErrorDetails = document.getElementById('errorDetails');
            if (existingErrorDetails) {
                existingErrorDetails.remove();
            }
            
            const homepage = document.getElementById('homepage');
            if (homepage) {
                homepage.classList.add('active');
                console.log('חזר לדף הבית');
                window.scrollTo(0, 0);
            }
        }

        function startWriting(type) {
            const typeNames = {
                'argumentative': 'החיבור הטיעוני',
                'descriptive': 'הכתיבה היצירתית',
                'formal_letter': 'המכתב הרשמי'
            };
            
            alert('🎉 מעולה! עכשיו אתה מוכן להתחיל לכתוב את ' + typeNames[type] + ' שלך!\n\n💡 טיפ: שמור את המתווה בצד וכתוב לפיו את החיבור במחברת או במחשב.\n\nבהצלחה! 🚀');
        }

        function generateOutline(type) {
            let outlineHtml = '';

            switch(type) {
                case 'argumentative':
                    const argTopic = document.getElementById('argTopic').value;
                    const argPosition = document.getElementById('argPosition').value;
                    const argArguments = document.getElementById('argArguments').value;
                    const argCounterArgument = document.getElementById('argCounterArgument').value;
                    const argRefutation = document.getElementById('argRefutation').value;
                    const argSummary = document.getElementById('argSummary').value;

                    if (!argTopic || !argPosition || !argArguments || !argCounterArgument || !argRefutation || !argSummary) {
                        showMessage('אנא מלא את כל השדות כדי לקבל מתווה מותאם!', 'error');
                        return;
                    }

                    const argsList = argArguments.split('\n').filter(arg => arg.trim());
                    
                    outlineHtml = '<div style="background: #e8f5e8; border: 2px solid #4caf50; border-radius: 15px; padding: 25px; margin-top: 20px;">' +
                        '<h4 style="color: #2e7d32; margin-bottom: 20px; text-align: center;">🎯 המתווה שלך מוכן!</h4>' +
                        '<div style="background: white; padding: 25px; border-radius: 10px;">' +
                        '<h5 style="color: #1565c0; margin-bottom: 20px;">📝 מבנה החיבור הטיעוני:</h5>' +
                        '<p style="margin-bottom: 10px;"><strong>🌟 פתיחה:</strong> הצגת הנושא "' + argTopic + '"</p>' +
                        '<p style="margin-bottom: 10px;"><strong>🎯 הטענה שלך:</strong> ' + argPosition + '</p>';
                    
                    argsList.forEach((arg, index) => {
                        outlineHtml += '<p style="margin-bottom: 10px;"><strong>📍 טיעון ' + (index + 1) + ':</strong> ' + arg.trim() + '</p>';
                    });
                    
                    outlineHtml += '<p style="margin-bottom: 10px;"><strong>⚖️ טענת הנגד:</strong> ' + argCounterArgument + '</p>' +
                        '<p style="margin-bottom: 10px;"><strong>💪 הפרכה:</strong> ' + argRefutation + '</p>' +
                        '<p style="margin-bottom: 10px;"><strong>🎯 סיכום והמלצה:</strong> ' + argSummary + '</p>' +
                        '</div>' +
                        '<div style="margin-top: 20px; text-align: center;">' +
                        '<button class="btn-primary" onclick="startWriting(\'argumentative\')">התחל לכתוב את החיבור! ✍️</button>' +
                        '</div>' +
                        '</div>';
                    document.getElementById('argOutline').innerHTML = outlineHtml;
                    break;

                case 'descriptive':
                    const descTopic = document.getElementById('descTopic').value;
                    const descMainImpression = document.getElementById('descMainImpression').value;
                    const descAspects = document.getElementById('descAspects').value;
                    const descSenses = document.getElementById('descSenses').value;

                    if (!descTopic || !descMainImpression || !descAspects || !descSenses) {
                        showMessage('אנא מלא את כל השדות כדי לקבל מתווה מותאם!', 'error');
                        return;
                    }

                    const aspectsList = descAspects.split('\n').filter(aspect => aspect.trim());
                    
                    outlineHtml = '<div style="background: #e8f5e8; border: 2px solid #4caf50; border-radius: 15px; padding: 25px; margin-top: 20px;">' +
                        '<h4 style="color: #2e7d32; margin-bottom: 20px; text-align: center;">🎨 המתווה שלך מוכן!</h4>' +
                        '<div style="background: white; padding: 25px; border-radius: 10px;">' +
                        '<h5 style="color: #1565c0; margin-bottom: 20px;">📝 מבנה הכתיבה היצירתית:</h5>' +
                        '<p style="margin-bottom: 10px;"><strong>🌟 הרעיון:</strong> ' + descTopic + '</p>' +
                        '<p style="margin-bottom: 10px;"><strong>👥 דמויות ומקום:</strong> ' + descMainImpression + '</p>' +
                        '<p style="margin-bottom: 10px;"><strong>📖 עלילה:</strong></p>';
                    
                    aspectsList.forEach((aspect, index) => {
                        outlineHtml += '<p style="margin-bottom: 10px;"><strong>🎭 שלב ' + (index + 1) + ':</strong> ' + aspect.trim() + '</p>';
                    });
                    
                    outlineHtml += '<p style="margin-bottom: 10px;"><strong>✨ סגנון כתיבה:</strong> ' + descSenses + '</p>' +
                        '</div>' +
                        '<div style="margin-top: 20px; text-align: center;">' +
                        '<button class="btn-primary" onclick="startWriting(\'descriptive\')">התחל לכתוב! ✍️</button>' +
                        '</div>' +
                        '</div>';
                    document.getElementById('descOutline').innerHTML = outlineHtml;
                    break;

                case 'formal_letter':
                    const formalPurpose = document.getElementById('formalPurpose').value;
                    const formalRecipient = document.getElementById('formalRecipient').value;
                    const formalMainPoints = document.getElementById('formalMainPoints').value;
                    const formalDetails = document.getElementById('formalDetails').value;

                    if (!formalPurpose || !formalRecipient || !formalMainPoints) {
                        showMessage('אנא מלא את השדות החובה כדי לקבל מתווה מותאם!', 'error');
                        return;
                    }

                    const pointsList = formalMainPoints.split('\n').filter(point => point.trim());
                    
                    outlineHtml = '<div style="background: #e8f5e8; border: 2px solid #4caf50; border-radius: 15px; padding: 25px; margin-top: 20px;">' +
                        '<h4 style="color: #2e7d32; margin-bottom: 20px; text-align: center;">📋 המתווה שלך מוכן!</h4>' +
                        '<div style="background: white; padding: 25px; border-radius: 10px;">' +
                        '<h5 style="color: #1565c0; margin-bottom: 20px;">📝 מבנה המכתב הרשמי:</h5>' +
                        '<p style="margin-bottom: 10px;"><strong>📍 כתובת ותאריך</strong></p>' +
                        '<p style="margin-bottom: 10px;"><strong>📮 נמען:</strong> ' + formalRecipient + '</p>' +
                        '<p style="margin-bottom: 10px;"><strong>📋 מטרה:</strong> ' + formalPurpose + '</p>' +
                        '<p style="margin-bottom: 10px;"><strong>🌟 פתיחה מנומסת</strong></p>';
                    
                    pointsList.forEach((point, index) => {
                        outlineHtml += '<p style="margin-bottom: 10px;"><strong>📍 נקודה ' + (index + 1) + ':</strong> ' + point.trim() + '</p>';
                    });
                    
                    if (formalDetails) {
                        outlineHtml += '<p style="margin-bottom: 10px;"><strong>📄 פרטים נוספים:</strong> ' + formalDetails + '</p>';
                    }
                    
                    outlineHtml += '<p style="margin-bottom: 10px;"><strong>🎯 סיום וחתימה מנומסת</strong></p>' +
                        '</div>' +
                        '<div style="margin-top: 20px; text-align: center;">' +
                        '<button class="btn-primary" onclick="startWriting(\'formal_letter\')">התחל לכתוב את המכתב! ✍️</button>' +
                        '</div>' +
                        '</div>';
                    document.getElementById('formalOutline').innerHTML = outlineHtml;
                    break;
            }

            showMessage('המתווה נוצר בהצלחה! 🎉', 'success');
        }

        async function checkSpellingBeforeOutline(sectionType) {
            const section = document.getElementById(sectionType);
            const inputs = section.querySelectorAll('input, textarea');
            let totalWords = 0;
            let allText = '';

            // איסוף כל הטקסט
            for (const input of inputs) {
                if (input.value.trim()) {
                    allText += input.value + ' ';
                    totalWords += input.value.split(/\s+/).length;
                }
            }

            if (totalWords === 0) {
                showMessage('⚠️ אנא מלא את השדות לפני בדיקת כתיב', 'error');
                return;
            }

            showMessage('🔍 מפנה לבדיקת כתיב מקצועית באתרי עברית...', 'info');

            // הסר הודעות קודמות
            const existingErrorDetails = document.getElementById('errorDetails');
            if (existingErrorDetails) {
                existingErrorDetails.remove();
            }

            // הפניה ישירה לכלי בדיקת כתיב מקצועיים
            showHebrewSpellingCheckSites(allText, totalWords);
        }

        function showHebrewSpellingCheckSites(fullText, totalWords) {
            const helpDiv = document.createElement('div');
            helpDiv.id = 'errorDetails';
            helpDiv.className = 'chatgpt-redirect';
            
            let helpHtml = '<h4>📋 בדיקת כתיב מקצועית - בדוק באתרי עברית מומחים!</h4>';
            helpHtml += '<p><strong>הטקסט שלך מוכן לבדיקה:</strong> ' + totalWords + ' מילים נכתבו ומחכות לבדיקה מקצועית.</p>';
            helpHtml += '<p><strong>למה חשוב לבדוק?</strong> גם כותבים מנוסים עושים שגיאות כתיב. בדיקה מקצועית תבטיח שהחיבור שלך יהיה מושלם!</p>';
            
            // אתרי בדיקת כתיב מקצועיים
            helpHtml += '<div style="background: #e8f5e8; padding: 25px; border-radius: 15px; margin: 20px 0; border: 3px solid #28a745;">';
            helpHtml += '<h5 style="color: #155724; margin-bottom: 20px; text-align: center; font-size: 1.3em;">🇮🇱 כלי בדיקת כתיב מקצועיים בעברית</h5>';
            
            
            // 1. מורפיקס - המילון המוביל
            helpHtml += '<div style="background: white; padding: 20px; border-radius: 12px; margin: 20px 0; border: 2px solid #2196f3; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">';
            helpHtml += '<h6 style="color: #1976d2; margin-bottom: 15px; font-size: 1.2em;">📖 מורפיקס - המילון הישראלי המוביל</h6>';
            helpHtml += '<p style="margin-bottom: 15px; color: #333; line-height: 1.6;">המילון הכי מהימן בישראל. מושלם לבדיקת מילים ספציפיות וכללי כתיב.</p>';
            
            helpHtml += '<div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #2196f3;">';
            helpHtml += '<h7 style="color: #1976d2; font-weight: bold; display: block; margin-bottom: 10px;">🔍 איך להשתמש:</h7>';
            helpHtml += '<ul style="margin: 0; padding-right: 20px; color: #333;">';
            helpHtml += '<li>חפש כל מילה שאתה לא בטוח בכתיבה שלה</li>';
            helpHtml += '<li>בדוק את הכתיב הנכון והמשמעות</li>';
            helpHtml += '<li>קרא דוגמאות לשימוש נכון</li>';
            helpHtml += '</ul>';
            helpHtml += '</div>';
            
            helpHtml += '<div style="text-align: center; margin: 15px 0;">';
            helpHtml += '<a href="https://www.morfix.co.il/" target="_blank" class="btn-chatgpt" style="background: #2196f3; font-size: 16px; padding: 12px 25px;">';
            helpHtml += '📚 פתח מורפיקס';
            helpHtml += '</a>';
            helpHtml += '</div>';
            helpHtml += '</div>';
            
            // 2. האקדמיה ללשון העברית
            helpHtml += '<div style="background: white; padding: 20px; border-radius: 12px; margin: 20px 0; border: 2px solid #6f42c1; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">';
            helpHtml += '<h6 style="color: #6f42c1; margin-bottom: 15px; font-size: 1.2em;">🎓 האקדמיה ללשון העברית</h6>';
            helpHtml += '<p style="margin-bottom: 15px; color: #333; line-height: 1.6;">הגוף הרשמי לקביעת כללי הכתיב בעברית. המקור הסמכותי ביותר!</p>';
            
            helpHtml += '<div style="background: #f3e5ff; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #6f42c1;">';
            helpHtml += '<h7 style="color: #6f42c1; font-weight: bold; display: block; margin-bottom: 10px;">⚖️ מתי להשתמש:</h7>';
            helpHtml += '<ul style="margin: 0; padding-right: 20px; color: #333;">';
            helpHtml += '<li>כשיש ספק בכללי דקדוק מסובכים</li>';
            helpHtml += '<li>לבירור כתיב של מילים זרות בעברית</li>';
            helpHtml += '<li>להבנת כללי פיסוק נכונים</li>';
            helpHtml += '</ul>';
            helpHtml += '</div>';
            
            helpHtml += '<div style="text-align: center; margin: 15px 0;">';
            helpHtml += '<a href="https://hebrew-academy.org.il/" target="_blank" class="btn-chatgpt" style="background: #6f42c1; font-size: 16px; padding: 12px 25px;">';
            helpHtml += '🏛️ פתח אתר האקדמיה';
            helpHtml += '</a>';
            helpHtml += '</div>';
            helpHtml += '</div>';
            
            helpHtml += '</div>';
            
            // צ'אט GPT עם הטקסט המלא
            helpHtml += '<div style="background: #f0f8ff; padding: 25px; border-radius: 15px; margin: 20px 0; border: 3px solid #007bff;">';
            helpHtml += '<h5 style="color: #0056b3; margin-bottom: 20px; text-align: center; font-size: 1.3em;">🤖 בדיקה מתקדמת עם צ\'אט GPT</h5>';
            
            // הכנת שאילתה מפורטת לצ'אט GPT
            const truncatedText = fullText.length > 800 ? fullText.substring(0, 800) + '...' : fullText;
            
            const detailedQuery = `שלום! אני תלמיד ואני צריך עזרה בבדיקת שגיאות כתיב ודקדוק בחיבור שכתבתי בעברית.

הטקסט שלי (${totalWords} מילים):
"${truncatedText}"

אתה יכול לעזור לי עם:
1. 🔍 זיהוי שגיאות כתיב וכתיבה מחדש נכונה
2. 📝 בדיקת דקדוק ותחביר
3. ✅ בדיקת פיסוק וסימני הקראה
4. 💡 הצעות לשיפור הניסוח והסגנון
5. 📚 הסבר על חוקי כתיב שנעשה בהם שגיאות

אשמח אם תכתוב בצורה ברורה ומובנה עם הסברים פשוטים. תודה רבה!`;
            
            const chatGPTQuery = encodeURIComponent(detailedQuery);
            const chatGPTUrl = 'https://chat.openai.com/?q=' + chatGPTQuery;
            
            helpHtml += '<div style="background: white; padding: 20px; border-radius: 12px; border: 2px dashed #007bff;">';
            helpHtml += '<h6 style="color: #0056b3; margin-bottom: 15px; font-size: 1.1em;">🎯 בדיקה אישית וחכמה</h6>';
            helpHtml += '<p style="margin-bottom: 20px; color: #333; line-height: 1.6;">GPT יקבל את <strong>כל הטקסט שלך</strong> ויבדוק אותו במקצועיות רבה. זו הדרך הכי טובה לקבל עזרה מותאמת אישית!</p>';
            
            helpHtml += '<div style="background: #e8f4fd; padding: 20px; border-radius: 10px; margin-bottom: 20px;">';
            helpHtml += '<h7 style="color: #0056b3; font-weight: bold; display: block; margin-bottom: 15px; font-size: 1.1em;">✨ מה GPT יעשה עבורך:</h7>';
            helpHtml += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">';
            
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; border-right: 3px solid #28a745;">';
            helpHtml += '<strong style="color: #28a745;">🔍 זיהוי שגיאות</strong><br>';
            helpHtml += '<small style="color: #666;">כל שגיאת כתיב ודקדוק</small>';
            helpHtml += '</div>';
            
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; border-right: 3px solid #ff9800;">';
            helpHtml += '<strong style="color: #ff9800;">📝 הסברים</strong><br>';
            helpHtml += '<small style="color: #666;">למה כל שגיאה שגויה</small>';
            helpHtml += '</div>';
            
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; border-right: 3px solid #2196f3;">';
            helpHtml += '<strong style="color: #2196f3;">✅ תיקונים</strong><br>';
            helpHtml += '<small style="color: #666;">הכתיב הנכון לכל מילה</small>';
            helpHtml += '</div>';
            
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; border-right: 3px solid #6f42c1;">';
            helpHtml += '<strong style="color: #6f42c1;">💡 שיפורים</strong><br>';
            helpHtml += '<small style="color: #666;">הצעות לניסוח טוב יותר</small>';
            helpHtml += '</div>';
            
            helpHtml += '</div>';
            helpHtml += '</div>';
            
            helpHtml += '<div style="text-align: center;">';
            helpHtml += '<a href="' + chatGPTUrl + '" target="_blank" class="btn-chatgpt" style="font-size: 18px; padding: 15px 30px;">';
            helpHtml += '🚀 בדוק את הטקסט שלי ב-GPT';
            helpHtml += '</a>';
            helpHtml += '</div>';
            helpHtml += '</div>';
            
            helpHtml += '</div>';
            
            // הוראות מפורטות
            helpHtml += '<div style="background: #fff3cd; padding: 25px; border-radius: 15px; margin: 20px 0; border: 3px solid #ffc107;">';
            helpHtml += '<h5 style="color: #856404; margin-bottom: 20px; text-align: center; font-size: 1.2em;">📋 איך לבדוק את הטקסט שלך - המדריך המלא</h5>';
            
            helpHtml += '<div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #ffc107;">';
            helpHtml += '<h6 style="color: #856404; margin-bottom: 15px;">🎯 השלבים המומלצים:</h6>';
            helpHtml += '<ol style="padding-right: 25px; color: #856404; line-height: 2; font-size: 15px;">';
            helpHtml += '<li><strong>התחל עם מבדק כתיב:</strong> פתח את מבדק כתיב, העתק את כל הטקסט ובדוק שגיאות בסיסיות</li>';
            helpHtml += '<li><strong>השלם עם GPT:</strong> פתח את צ\'אט GPT לבדיקה מקיפה וחכמה של כל הטקסט</li>';
            helpHtml += '<li><strong>בדוק מילים ספציפיות במורפיקס:</strong> אם יש מילים שאתה לא בטוח בהן</li>';
            helpHtml += '<li><strong>תקן בטקסט המקורי:</strong> חזור לכאן ותקן את כל השגיאות ששגיאות שזוהו</li>';
            helpHtml += '<li><strong>בדוק שוב:</strong> לחץ על "בדוק שגיאות כתיב" כדי לוודא שהכל תוקן</li>';
            helpHtml += '<li><strong>צור מתווה:</strong> רק אחרי שאין שגיאות - צור את המתווה</li>';
            helpHtml += '</ol>';
            helpHtml += '</div>';
            
            helpHtml += '<div style="background: #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 20px; text-align: center;">';
            helpHtml += '<strong style="color: #856404;">💡 עצה חשובה:</strong> אל תסתפק בכלי אחד! השתמש במספר כלים כדי לוודא שהטקסט מושלם';
            helpHtml += '</div>';
            helpHtml += '</div>';
            
            // אזהרה חשובה
            helpHtml += '<div style="background: #f8d7da; padding: 20px; border-radius: 10px; margin: 20px 0; border: 3px solid #dc3545; text-align: center;">';
            helpHtml += '<h6 style="color: #721c24; margin-bottom: 10px; font-size: 1.1em;">⚠️ חשוב מאוד!</h6>';
            helpHtml += '<p style="color: #721c24; margin: 0; line-height: 1.6;">לא תוכל ליצור מתווה עד שתבדוק ותתקן את כל שגיאות הכתיב. מטרת המערכת היא לעזור לך להגיש חיבור מושלם!</p>';
            helpHtml += '</div>';

            helpDiv.innerHTML = helpHtml;
            
            const activeCard = document.querySelector('.step-content.active .card');
            if (activeCard) {
                activeCard.appendChild(helpDiv);
            }
        }

        function checkSpellingLocal(text) {
            const errors = [];
            
            // מילון מורחב של שגיאות כתיב נפוצות מאוד בעברית - רק שגיאות אמיתיות!
            const commonErrors = {
                // שגיאות בסיסיות נפוצות מאוד
                'בעייה': 'בעיה',
                'בעיות': 'בעיות',
                'שיכבה': 'שכבה',
                'שיחבה': 'שכבה',
                'שיבה': 'שכבה',
                'הולכ': 'הולך',
                'זכרון': 'זיכרון',
                'זכרונות': 'זיכרונות',
                'איפוא': 'אפוא',
                'מכיון': 'מכיוון',
                'באו': 'בואו',
                
                // שגיאות בפעלים - הוספת אותיות מיותרות
                'כתיבתי': 'כתבתי',
                'קריאתי': 'קראתי',
                'שמיעתי': 'שמעתי',
                'למידתי': 'למדתי',
                'הליכתי': 'הלכתי',
                'ראיותי': 'ראיתי',
                'שאילתי': 'שאלתי',
                'ענתי': 'עניתי',
                'אכילתי': 'אכלתי',
                'שתיותי': 'שתיתי',
                'ישינתי': 'ישנתי',
                'קימתי': 'קמתי',
                'שכיבתי': 'שכבתי',
                'עמידתי': 'עמדתי',
                'ריצתי': 'רצתי',
                'משחקתי': 'שיחקתי',
                'עבודתי': 'עבדתי',
                'אהבתי': 'אהבתי',
                'שנאותי': 'שנאתי',
                'פחידתי': 'פחדתי',
                'שמחותי': 'שמחתי',
                'בכיותי': 'בכיתי',
                'צחוקתי': 'צחקתי',
                'חשיבתי': 'חשבתי',
                'זכירתי': 'זכרתי',
                'שכחותי': 'שכחתי',
                'הרגשותי': 'הרגשתי',
                'התחלותי': 'התחלתי',
                'סיומתי': 'סיימתי',
                'המשכותי': 'המשכתי',
                'עצירתי': 'עצרתי',
                'חזירתי': 'חזרתי',
                'הגעותי': 'הגעתי',
                'עזיבתי': 'עזבתי',
                'נשארותי': 'נשארתי',
                'חכיותי': 'חיכיתי',
                'קיוותי': 'קיוויתי',
                'רציותי': 'רציתי',
                'יכולותי': 'יכולתי',
                'נתינתי': 'נתתי',
                'לקיחתי': 'לקחתי',
                'קניותי': 'קניתי',
                'מכירתי': 'מכרתי',
                'סיפורתי': 'סיפרתי',
                'התקשרותי': 'התקשרתי',
                'פגישתי': 'פגשתי',
                'ביקורתי': 'ביקרתי',
                'טיולתי': 'טיילתי',
                'נסיעתי': 'נסעתי',
                
                // שגיאות עם י נוסף
                'ביית': 'בית',
                'בייתי': 'ביתי',
                'בייתים': 'בתים',
                'קיול': 'קול',
                'קיולות': 'קולות',
                'ייום': 'יום',
                'ייומים': 'יומים',
                'לייל': 'ליל',
                'לייליים': 'לילי',
                'לייד': 'ליד',
                'שיירה': 'שירה',
                'שייר': 'שיר',
                'שיירים': 'שירים',
                'מיילה': 'מילה',
                'מיילים': 'מילים',
                'נסייעה': 'נסיעה',
                'נסייעות': 'נסיעות',
                'חייבור': 'חיבור',
                'חייבורים': 'חיבורים',
                'שייחה': 'שיחה',
                'שייחות': 'שיחות',
                'בייקור': 'ביקור',
                'בייקורים': 'ביקורים',
                'חיינות': 'חנות',
                'חיינויות': 'חנויות',
                'בקישה': 'בקשה',
                'בקישות': 'בקשות',
                'עיולם': 'עולם',
                'עיולמות': 'עולמות',
                'מישפט': 'משפט',
                'מישפטים': 'משפטים',
                'אייש': 'איש',
                'איישים': 'אנשים',
                'איישה': 'אישה',
                'אייש': 'אש',
                'לייש': 'ליש',
                'ליימוד': 'לימוד',
                'ליימודים': 'לימודים',
                'שייטה': 'שיטה',
                'שייטות': 'שיטות',
                'בחיירה': 'בחירה',
                'בחיירות': 'בחירות',
                'קרייאה': 'קריאה',
                'קרייאות': 'קריאות',
                
                // שגיאות ברבים
                'עינייים': 'עיניים',
                'ידייים': 'ידיים',
                'רגלייים': 'רגליים',
                'שינייים': 'שיניים',
                'אוזנייים': 'אוזניים',
                'שפתייים': 'שפתיים',
                'אצבעיות': 'אצבעות',
                'ציפורנייים': 'ציפורניים',
                'שערייות': 'שערות',
                
                // שגיאות נוספות נפוצות
                'אירע': 'ארע',
                'אירעה': 'ארעה',
                'אירעו': 'ארעו',
                'איחור': 'אחור',
                'איחוז': 'אחוז',
                'אימון': 'אמון',
                'אירוח': 'ארוח',
                'אישור': 'אשור',
                'גיבעה': 'גבעה',
                'גיבעות': 'גבעות',
                'היכן': 'היכן',
                'היכנו': 'הכנו',
                'בלילה': 'בליל',
                'בליילה': 'בליל',
                'איתי': 'איתי',
                'איתך': 'איתך',
                'איתו': 'איתו',
                'איתה': 'איתה',
                'איתנו': 'איתנו',
                'איתכם': 'איתכם',
                'איתן': 'איתן',
                'איתהן': 'איתהן',
                
                // שגיאות בזמנים
                'בוקר': 'בוקר',
                'ביוקר': 'בוקר',
                'ציהריים': 'צהריים',
                'צייהריים': 'צהריים',
                'עיירב': 'ערב',
                'לייל': 'ליל',
                'לייליה': 'לילה',
                
                // שגיאות במקומות
                'בייתי': 'ביתי',
                'כייתה': 'כיתה',
                'כייתות': 'כיתות',
                'חיידר': 'חדר',
                'חיידרים': 'חדרים',
                'שיילחן': 'שולחן',
                'שיילחנות': 'שולחנות',
                'כיייסא': 'כיסא',
                'כיייסאות': 'כיסאות',
                'מייטה': 'מיטה',
                'מייטות': 'מיטות',
                'אירון': 'ארון',
                'אירונות': 'ארונות',
                'חיילון': 'חלון',
                'חיילונות': 'חלונות',
                'דיילת': 'דלת',
                'דיילתות': 'דלתות',
                'קייר': 'קיר',
                'קיירות': 'קירות',
                'תיקרה': 'תקרה',
                'תיקרות': 'תקרות',
                'ריצפה': 'רצפה',
                'ריצפות': 'רצפות',
                
                // שגיאות בפעולות יום יום
                'אוכיל': 'אוכל',
                'מיזון': 'מזון',
                'אירוחה': 'ארוחה',
                'אירוחות': 'ארוחות',
                'לייחם': 'לחם',
                'לייחמים': 'לחמים',
                'חייליב': 'חלב',
                'גביינה': 'גבינה',
                'גביינות': 'גבינות',
                'בייצה': 'ביצה',
                'בייצים': 'ביצים',
                'בייש': 'בשר',
                'דייג': 'דג',
                'דייגים': 'דגים',
                'עיוף': 'עוף',
                'עיופות': 'עופות',
                'יירק': 'ירק',
                'יירקות': 'ירקות',
                'פייר': 'פרי',
                'פיירות': 'פירות',
                'תייפוח': 'תפוח',
                'תייפוחים': 'תפוחים',
                'בייננה': 'בננה',
                'בייננות': 'בננות',
                'אייגס': 'אגס',
                'אייגסים': 'אגסים',
                'תייפוז': 'תפוז',
                'תייפוזים': 'תפוזים',
                'לייימון': 'לימון',
                'לייימונים': 'לימונים',
                'גייזר': 'גזר',
                'גייזרים': 'גזרים',
                'עיגבניה': 'עגבניה',
                'עיגבניות': 'עגבניות',
                'מילפפון': 'מלפפון',
                'מילפפונים': 'מלפפונים',
                'בייצל': 'בצל',
                'בייצלים': 'בצלים',
                'שיום': 'שום',
                'פייליפל': 'פלפל',
                'פייליפלים': 'פלפלים',
                'מייים': 'מים',
                'מייץ': 'מיץ',
                'מייצים': 'מיצים',
                'קייפה': 'קפה',
                'תייה': 'תה',
                'שיוקו': 'שוקו',
                'שיוקולד': 'שוקולד',
                'שיוקולדים': 'שוקולדים',
                'עיוגה': 'עוגה',
                'עיוגות': 'עוגות',
                'מיימתק': 'ממתק',
                'מיימתקים': 'ממתקים',
                
                // בגדים וחפצים
                'בייגד': 'בגד',
                'בייגדים': 'בגדים',
                'חיולצה': 'חולצה',
                'חיולצות': 'חולצות',
                'מיכנסיים': 'מכנסיים',
                'שיימלה': 'שמלה',
                'שיימלות': 'שמלות',
                'חיצאיית': 'חצאית',
                'חיצאיות': 'חצאיות',
                'נייעל': 'נעל',
                'נייעלייים': 'נעליים',
                'גייריב': 'גרב',
                'גייריביים': 'גרביים',
                'מייעייל': 'מעיל',
                'מייעיילים': 'מעילים',
                'כייוביע': 'כובע',
                'כייוביעים': 'כובעים',
                'מישקפייים': 'משקפיים',
                'שייעון': 'שעון',
                'שייעונים': 'שעונים',
                'תייק': 'תיק',
                'תייקים': 'תיקים',
                'מיחברת': 'מחברת',
                'מיחברות': 'מחברות',
                'עייפרון': 'עיפרון',
                'עייפרונות': 'עיפרונות',
                'עייט': 'עט',
                'עייטים': 'עטים',
                'מייחק': 'מחק',
                'מייחקים': 'מחקים',
                'סיירגל': 'סרגל',
                'סיירגלים': 'סרגלים',
                'מיספרייים': 'מספריים',
                'דייבק': 'דבק',
                'נייר': 'נייר',
                'נייירות': 'ניירות',
                'מייסמך': 'מסמך',
                'מייסמכים': 'מסמכים',
                
                // אנשים ויחסים
                'אינשים': 'אנשים',
                'איידם': 'אדם',
                'בין אידם': 'בן אדם',
                'בינייי אידם': 'בני אדם',
                'אייש': 'איש',
                'איישיה': 'אישה',
                'גייביר': 'גבר',
                'אייממא': 'אמא',
                'אייבייבא': 'אבא',
                'הייוריים': 'הורים',
                'מישפייחה': 'משפחה',
                'מישפייחות': 'משפחות',
                'יייליד': 'ילד',
                'יייליידה': 'ילדה',
                'יייליידים': 'ילדים',
                'יייליידות': 'ילדות',
                'בייין': 'בן',
                'בייייית': 'בת',
                'בייינייים': 'בנים',
                'בייינייות': 'בנות',
                'אייח': 'אח',
                'אייחייות': 'אחות',
                'אייחייים': 'אחים',
                'אייחיייות': 'אחיות',
                'סייבא': 'סבא',
                'סייבתא': 'סבתא',
                'סייבים': 'סבים',
                'סייבתות': 'סבתות',
                'דייוד': 'דוד',
                'דייודה': 'דודה',
                'דייודים': 'דודים',
                'דייודות': 'דודות',
                'חייביר': 'חבר',
                'חייבירה': 'חברה',
                'חייבירייים': 'חברים',
                'חייבירייות': 'חברות',
                'יייידיייד': 'ידיד',
                'יייידיייידה': 'ידידה',
                'יייידיייידים': 'ידידים',
                'יייידיייידות': 'ידידות'
            };

            // בדיקת שגיאות נפוצות
            Object.keys(commonErrors).forEach(wrongWord => {
                const regex = new RegExp('\\b' + wrongWord + '\\b', 'gi');
                const matches = text.match(regex);
                if (matches) {
                    matches.forEach(() => {
                        errors.push({
                            word: wrongWord,
                            suggestion: commonErrors[wrongWord],
                            type: 'שגיאת כתיב נפוצה',
                            message: 'שגיאת כתיב שכיחה בעברית'
                        });
                    });
                }
            });

            // בדיקת מילים באנגלית
            const englishWords = text.match(/\b[a-zA-Z]{3,}\b/g);
            if (englishWords) {
                englishWords.forEach(word => {
                    errors.push({
                        word: word,
                        suggestion: 'השתמש במילה בעברית',
                        type: 'מילה באנגלית',
                        message: 'מילה באנגלית במקום עברית'
                    });
                });
            }

            // בדיקת חזרות מיותרות
            const words = text.split(/\s+/);
            for (let i = 0; i < words.length - 1; i++) {
                const cleanWord1 = words[i].replace(/[^\u0590-\u05FF\u0041-\u005A\u0061-\u007A]/g, '');
                const cleanWord2 = words[i + 1].replace(/[^\u0590-\u05FF\u0041-\u005A\u0061-\u007A]/g, '');
                
                if (cleanWord1.toLowerCase() === cleanWord2.toLowerCase() && cleanWord1.length > 2) {
                    errors.push({
                        word: 'חזרה על המילה "' + cleanWord1 + '"',
                        suggestion: 'הסר את החזרה המיותרת',
                        type: 'חזרה מיותרת',
                        message: 'מילה חוזרת פעמיים ברצף'
                    });
                }
            }

            return errors;
        }

        function showHebrewSitesSpellingHelp(errorWords, fullText, totalWords) {
            const helpDiv = document.createElement('div');
            helpDiv.id = 'errorDetails';
            helpDiv.className = 'chatgpt-redirect';
            
            let helpHtml = '<h4>🔍 נמצאו שגיאות כתיב - השתמש באתרי עברית מקצועיים!</h4>';
            helpHtml += '<p><strong>סטטוס:</strong> זוהו שגיאות כתיב מתוך ' + totalWords + ' מילים שנבדקו.</p>';
            helpHtml += '<p><strong>המלצה:</strong> השתמש באתרים המקצועיים הבאים לבדיקה ותיקון מדויק:</p>';
            
            // הצגת השגיאות שנמצאו
            if (errorWords.length > 0) {
                helpHtml += '<div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0; border: 2px solid #dc3545;">';
                helpHtml += '<h5 style="color: #dc3545; margin-bottom: 15px;">❌ שגיאות שזוהו:</h5>';
                
                const uniqueWords = [...new Set(errorWords.map(error => error.word))];
                uniqueWords.slice(0, 8).forEach((word) => {
                    const errorInfo = errorWords.find(e => e.word === word);
                    helpHtml += '<div style="background: #fff5f5; border: 1px solid #dc3545; border-radius: 8px; padding: 12px; margin: 8px 0; display: flex; justify-content: space-between; align-items: center;">';
                    helpHtml += '<span style="color: #dc3545; font-weight: bold;">❌ "' + word + '"</span>';
                    helpHtml += '<span style="color: #28a745; font-weight: bold;">➡️ "' + errorInfo.suggestion + '"</span>';
                    helpHtml += '</div>';
                });
                
                if (uniqueWords.length > 8) {
                    helpHtml += '<p style="text-align: center; color: #666; font-style: italic;">ועוד ' + (uniqueWords.length - 8) + ' שגיאות נוספות...</p>';
                }
                
                helpHtml += '</div>';
            }
            
            // אתרים עבריים מקצועיים לבדיקת כתיב
            helpHtml += '<div style="background: #e8f5e8; padding: 20px; border-radius: 10px; margin: 15px 0; border: 2px solid #28a745;">';
            helpHtml += '<h5 style="color: #155724; margin-bottom: 20px; text-align: center;">🇮🇱 אתרי עברית מקצועיים לבדיקת כתיב</h5>';
            
            // 1. מורפיקס - המילון המוביל בישראל
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #2196f3;">';
            helpHtml += '<h6 style="color: #1976d2; margin-bottom: 10px;">📖 מורפיקס - המילון הישראלי המוביל</h6>';
            helpHtml += '<p style="margin-bottom: 12px; font-size: 14px; color: #555;">מילון מקצועי עם בדיקת כתיב מתקדמת לעברית</p>';
            helpHtml += '<a href="https://www.morfix.co.il/" target="_blank" class="btn-chatgpt" style="background: #2196f3; margin: 5px;">';
            helpHtml += '🔍 פתח מורפיקס לבדיקת כתיב';
            helpHtml += '</a>';
            helpHtml += '<p style="font-size: 12px; color: #666; margin-top: 8px;"><strong>איך להשתמש:</strong> חפש כל מילה שגויה והעתק את הטקסט שלך לבדיקה</p>';
            helpHtml += '</div>';
            
            // 2. האקדמיה ללשון העברית
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #6f42c1;">';
            helpHtml += '<h6 style="color: #6f42c1; margin-bottom: 10px;">🎓 האקדמיה ללשון העברית</h6>';
            helpHtml += '<p style="margin-bottom: 12px; font-size: 14px; color: #555;">הגוף הרשמי לקביעת כללי הכתיב הנכון בעברית</p>';
            helpHtml += '<a href="https://hebrew-academy.org.il/" target="_blank" class="btn-chatgpt" style="background: #6f42c1; margin: 5px;">';
            helpHtml += '📚 פתח אתר האקדמיה';
            helpHtml += '</a>';
            helpHtml += '<p style="font-size: 12px; color: #666; margin-top: 8px;"><strong>איך להשתמש:</strong> חפש כללי כתיב ודקדוק, השתמש בחיפוש באתר</p>';
            helpHtml += '</div>';
            
            // 3. מבדק כתיב
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #ff9800;">';
            helpHtml += '<h6 style="color: #f57c00; margin-bottom: 10px;">✅ מבדק כתיב אונליין</h6>';
            helpHtml += '<p style="margin-bottom: 12px; font-size: 14px; color: #555;">כלי מקוון לבדיקת שגיאות כתיב בעברית</p>';
            helpHtml += '<a href="https://www.mivdak.co.il/" target="_blank" class="btn-chatgpt" style="background: #ff9800; margin: 5px;">';
            helpHtml += '🔧 פתח מבדק כתיב';
            helpHtml += '</a>';
            helpHtml += '<p style="font-size: 12px; color: #666; margin-top: 8px;"><strong>איך להשתמש:</strong> העתק את כל הטקסט שלך לבדיקה מהירה</p>';
            helpHtml += '</div>';
            
            // 4. ויקימילון
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #00bcd4;">';
            helpHtml += '<h6 style="color: #0097a7; margin-bottom: 10px;">📘 ויקימילון עברית</h6>';
            helpHtml += '<p style="margin-bottom: 12px; font-size: 14px; color: #555;">מילון קהילתי עם דוגמאות שימוש נרחבות</p>';
            helpHtml += '<a href="https://he.wiktionary.org/" target="_blank" class="btn-chatgpt" style="background: #00bcd4; margin: 5px;">';
            helpHtml += '📖 פתח ויקימילון';
            helpHtml += '</a>';
            helpHtml += '<p style="font-size: 12px; color: #666; margin-top: 8px;"><strong>איך להשתמש:</strong> חפש מילים ותראה דוגמאות לשימוש נכון</p>';
            helpHtml += '</div>';
            
            helpHtml += '</div>';
            
            // צ'אט GPT עם הטקסט המלא
            helpHtml += '<div style="background: #f0f8ff; padding: 20px; border-radius: 10px; margin: 15px 0; border: 2px solid #007bff;">';
            helpHtml += '<h5 style="color: #0056b3; margin-bottom: 15px; text-align: center;">🤖 בדיקה מתקדמת עם צ\'אט GPT</h5>';
            
            // הכנת שאילתה מפורטת לצ'אט GPT
            const truncatedText = fullText.length > 500 ? fullText.substring(0, 500) + '...' : fullText;
            const errorWordsText = errorWords.map(e => e.word).slice(0, 10).join(', ');
            
            const detailedQuery = `שלום! אני תלמיד וכתבתי חיבור בעברית. אתה יכול לבדוק לי שגיאות כתיב ודקדוק?

זוהו השגיאות הבאות: ${errorWordsText}

הטקסט שלי:
"${truncatedText}"

בבקשה:
1. בדוק שגיאות כתיב נוספות שלא זוהו
2. הסבר מה השגיאות ואיך לתקן
3. תן טיפים לכתיבה נכונה בעברית
4. בדוק גם דקדוק ופיסוק

תודה!`;
            
            const chatGPTQuery = encodeURIComponent(detailedQuery);
            const chatGPTUrl = 'https://chat.openai.com/?q=' + chatGPTQuery;
            
            helpHtml += '<div style="background: white; padding: 15px; border-radius: 8px; border: 2px dashed #007bff;">';
            helpHtml += '<h6 style="color: #0056b3; margin-bottom: 12px;">🎯 בדיקה אישית מותאמת</h6>';
            helpHtml += '<p style="margin-bottom: 15px; color: #333;">צ\'אט GPT יבדוק את <strong>כל הטקסט שלך</strong> ויתן הסברים מפורטים על כל שגיאה</p>';
            
            helpHtml += '<div style="background: #f8f9fa; padding: 12px; border-radius: 6px; margin-bottom: 15px; border-right: 3px solid #28a745;">';
            helpHtml += '<h7 style="color: #155724; font-weight: bold;">✨ מה GPT יעשה עבורך:</h7>';
            helpHtml += '<ul style="margin: 8px 0; padding-right: 20px; color: #333; font-size: 14px;">';
            helpHtml += '<li>יבדוק שגיאות כתיב נוספות</li>';
            helpHtml += '<li>יסביר את החוקים הדקדוקיים</li>';
            helpHtml += '<li>יבדוק פיסוק וסימני הקראה</li>';
            helpHtml += '<li>יתן טיפים לשיפור הכתיבה</li>';
            helpHtml += '</ul>';
            helpHtml += '</div>';
            
            helpHtml += '<a href="' + chatGPTUrl + '" target="_blank" class="btn-chatgpt" style="font-size: 16px; padding: 12px 25px;">';
            helpHtml += '🚀 פתח צ\'אט GPT עם הטקסט שלך';
            helpHtml += '</a>';
            helpHtml += '</div>';
            
            helpHtml += '</div>';
            
            // הוראות מפורטות
            helpHtml += '<div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin: 15px 0; border: 2px solid #ffc107;">';
            helpHtml += '<h5 style="color: #856404; margin-bottom: 15px;">📋 סדר פעולות מומלץ:</h5>';
            helpHtml += '<ol style="padding-right: 25px; color: #856404; line-height: 1.8; font-size: 15px;">';
            helpHtml += '<li><strong>התחל עם צ\'אט GPT:</strong> הכי מתקדם ויעיל - יבדוק את כל הטקסט בבת אחת</li>';
            helpHtml += '<li><strong>השתמש במורפיקס:</strong> לבדיקת מילים ספציפיות שאתה לא בטוח בהן</li>';
            helpHtml += '<li><strong>בדוק באקדמיה:</strong> אם יש ספק בכללי דקדוק או כתיב</li>';
            helpHtml += '<li><strong>תקן בטקסט שלך:</strong> עבור על כל שגיאה ותקן ברגע בו כתבת</li>';
            helpHtml += '<li><strong>בדוק שוב:</strong> לחץ על "בדוק שגיאות כתיב" אחרי התיקונים</li>';
            helpHtml += '<li><strong>רק אחרי תיקון הכל:</strong> תוכל ליצור את המתווה</li>';
            helpHtml += '</ol>';
            helpHtml += '</div>';
            
            // אזהרה
            helpHtml += '<div style="background: #f8d7da; padding: 15px; border-radius: 8px; margin: 15px 0; border: 2px solid #dc3545; text-align: center;">';
            helpHtml += '<h6 style="color: #721c24; margin-bottom: 8px;">⚠️ לא ניתן להמשיך עם שגיאות כתיב!</h6>';
            helpHtml += '<p style="color: #721c24; margin: 0; font-size: 14px;">המערכת תאפשר יצירת מתווה רק אחרי שכל השגיאות יתוקנו</p>';
            helpHtml += '</div>';

            helpDiv.innerHTML = helpHtml;
            
            const activeCard = document.querySelector('.step-content.active .card');
            if (activeCard) {
                activeCard.appendChild(helpDiv);
            }
        }

        // בדיקת שגיאות כתיב עם כלי AI מתקדמים
        async function checkSpellingWithAI(text) {
            const errors = [];
            
            // ניסיון 1: LanguageTool API (שירות מקצועי לבדיקת כתיב)
            try {
                showMessage('🔗 מתחבר לשירות LanguageTool AI...', 'info');
                const response = await fetch('https://api.languagetool.org/v2/check', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        'text': text,
                        'language': 'he-IL', // עברית
                        'enabledOnly': 'false',
                        'level': 'picky' // בדיקה מחמירה
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    showMessage('✅ LanguageTool AI זיהה ' + data.matches.length + ' בעיות', 'info');
                    
                    data.matches.forEach(match => {
                        const errorWord = text.substring(match.offset, match.offset + match.length);
                        const suggestion = match.replacements && match.replacements.length > 0 
                            ? match.replacements[0].value 
                            : 'בדוק את הכתיב';
                        
                        errors.push({
                            word: errorWord,
                            suggestion: suggestion,
                            type: 'שגיאה מזוהה על ידי AI',
                            message: match.message || 'שגיאת כתיב שזוהתה על ידי בינה מלאכותית',
                            category: match.rule ? match.rule.category.name : 'כתיב'
                        });
                    });
                    
                    return errors;
                }
            } catch (error) {
                console.log('LanguageTool לא זמין:', error);
            }

            // ניסיון 2: Microsoft Cognitive Services (Bing Spell Check)
            try {
                showMessage('🔗 מתחבר לשירות Microsoft AI...', 'info');
                const response = await fetch('https://api.cognitive.microsoft.com/bing/v7.0/spellcheck', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Ocp-Apim-Subscription-Key': 'demo-key' // נשתמש במפתח דמו
                    },
                    body: new URLSearchParams({
                        'text': text,
                        'mode': 'proof',
                        'mkt': 'he-IL'
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    showMessage('✅ Microsoft AI זיהה ' + data.flaggedTokens.length + ' בעיות', 'info');
                    
                    data.flaggedTokens.forEach(token => {
                        const suggestion = token.suggestions && token.suggestions.length > 0 
                            ? token.suggestions[0].suggestion 
                            : 'בדוק את הכתיב';
                        
                        errors.push({
                            word: token.token,
                            suggestion: suggestion,
                            type: 'שגיאה מזוהה על ידי Microsoft AI',
                            message: 'שגיאת כתיב שזוהתה על ידי בינה מלאכותית של Microsoft',
                            category: token.type
                        });
                    });
                    
                    return errors;
                }
            } catch (error) {
                console.log('Microsoft AI לא זמין:', error);
            }

            // ניסיון 3: TextGears API
            try {
                showMessage('🔗 מתחבר לשירות TextGears AI...', 'info');
                const response = await fetch('https://api.textgears.com/spelling', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        'text': text,
                        'language': 'he-IL',
                        'key': 'demo' // מפתח דמו
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    showMessage('✅ TextGears AI זיהה ' + data.errors.length + ' בעיות', 'info');
                    
                    data.errors.forEach(error => {
                        const suggestion = error.better && error.better.length > 0 
                            ? error.better[0] 
                            : 'בדוק את הכתיב';
                        
                        errors.push({
                            word: error.bad,
                            suggestion: suggestion,
                            type: 'שגיאה מזוהה על ידי TextGears AI',
                            message: 'שגיאת כתיב שזוהתה על ידי בינה מלאכותית',
                            category: 'spelling'
                        });
                    });
                    
                    return errors;
                }
            } catch (error) {
                console.log('TextGears AI לא זמין:', error);
            }

            // אם כל השירותים לא זמינים, נשתמש בבדיקה מקומית משופרת
            showMessage('⚠️ שירותי AI חיצוניים לא זמינים, עובר לבדיקה מקומית מתקדמת', 'info');
            return checkSpellingAdvancedLocal(text);
        }

        // בדיקה מקומית מתקדמת כגיבוי
        function checkSpellingAdvancedLocal(text) {
            const errors = [];
            
            // שגיאות כתיב נפוצות מאוד בעברית
            const commonErrors = {
                'בעייה': 'בעיה',
                'שיכבה': 'שכבה',
                'הולכ': 'הולך',
                'זכרון': 'זיכרון',
                'איפוא': 'אפוא',
                'מכיון': 'מכיוון',
                'באו': 'בואו',
                'כתיבתי': 'כתבתי',
                'קריאתי': 'קראתי',
                'למידתי': 'למדתי',
                'ענתי': 'עניתי',
                'ביית': 'בית',
                'קיול': 'קול',
                'ייום': 'יום',
                'לייד': 'ליד',
                'עינייים': 'עיניים',
                'ידייים': 'ידיים',
                'רגלייים': 'רגליים'
            };

            Object.keys(commonErrors).forEach(wrongWord => {
                const regex = new RegExp('\\b' + wrongWord + '\\b', 'gi');
                const matches = text.match(regex);
                if (matches) {
                    matches.forEach(() => {
                        errors.push({
                            word: wrongWord,
                            suggestion: commonErrors[wrongWord],
                            type: 'שגיאה מזוהה מקומית',
                            message: 'שגיאת כתיב נפוצה בעברית'
                        });
                    });
                }
            });

            // בדיקת מילים באנגלית
            const englishWords = text.match(/\b[a-zA-Z]{3,}\b/g);
            if (englishWords) {
                englishWords.forEach(word => {
                    errors.push({
                        word: word,
                        suggestion: 'השתמש במילה בעברית',
                        type: 'מילה באנגלית',
                        message: 'מילה באנגלית במקום עברית'
                    });
                });
            }

            return errors;
        }

        function showAISpellingHelp(errorWords, totalWords) {
            const helpDiv = document.createElement('div');
            helpDiv.id = 'errorDetails';
            helpDiv.className = 'chatgpt-redirect';
            
            let helpHtml = '<h4>🤖 הבינה המלאכותית זיהתה שגיאות כתיב!</h4>';
            helpHtml += '<p><strong>בדיקה מתקדמת:</strong> המערכת השתמשה בכלי בינה מלאכותית מתקדמים כדי לזהות שגיאות כתיב בטקסט שלך.</p>';
            helpHtml += '<p><strong>תוצאות:</strong> נמצאו שגיאות כתיב מתוך ' + totalWords + ' מילים שנבדקו.</p>';
            
            // הצגת השגיאות שזוהו על ידי AI
            helpHtml += '<div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0; border: 2px solid #dc3545;">';
            helpHtml += '<h5 style="color: #dc3545; margin-bottom: 15px;">🔍 שגיאות כתיב שזוהו על ידי AI:</h5>';
            
            const uniqueWords = [...new Set(errorWords.map(error => error.word))];
            uniqueWords.forEach((word, index) => {
                const errorInfo = errorWords.find(e => e.word === word);
                helpHtml += '<div style="background: #fff5f5; border: 1px solid #dc3545; border-radius: 8px; padding: 15px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center;">';
                helpHtml += '<div>';
                helpHtml += '<span style="color: #dc3545; font-weight: bold; font-size: 16px;">❌ "' + word + '"</span>';
                helpHtml += '<br><small style="color: #666; font-style: italic;">' + errorInfo.type + '</small>';
                if (errorInfo.message) {
                    helpHtml += '<br><small style="color: #888;">' + errorInfo.message + '</small>';
                }
                helpHtml += '</div>';
                helpHtml += '<div style="text-align: left;">';
                helpHtml += '<span style="color: #28a745; font-weight: bold; font-size: 16px;">✅ "' + errorInfo.suggestion + '"</span>';
                helpHtml += '</div>';
                helpHtml += '</div>';
            });
            
            helpHtml += '</div>';
            
            // הוראות לתיקון
            helpHtml += '<div style="background: #e8f4fd; padding: 20px; border-radius: 10px; margin: 15px 0; border: 2px solid #007bff;">';
            helpHtml += '<h5 style="color: #0056b3; margin-bottom: 15px;">📋 איך לתקן את השגיאות:</h5>';
            helpHtml += '<ol style="padding-right: 20px; color: #0056b3; line-height: 1.8;">';
            helpHtml += '<li><strong>עבור על כל שגיאה:</strong> חפש את המילה השגויה בטקסט שלך</li>';
            helpHtml += '<li><strong>החלף למילה הנכונה:</strong> השתמש בהצעת התיקון שהAI נתן</li>';
            helpHtml += '<li><strong>בדוק שוב:</strong> לחץ על "בדוק שגיאות כתיב" אחרי התיקון</li>';
            helpHtml += '<li><strong>רק אחרי שאין שגיאות:</strong> תוכל ליצור את המתווה</li>';
            helpHtml += '</ol>';
            helpHtml += '</div>';
            
            // כלי עזרה נוספים
            helpHtml += '<div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin: 15px 0; border: 2px solid #ffc107;">';
            helpHtml += '<h5 style="color: #856404; margin-bottom: 15px;">🛠️ כלי עזרה נוספים:</h5>';
            
            helpHtml += '<div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">';
            
            // מורפיקס
            helpHtml += '<a href="https://www.morfix.co.il/" target="_blank" class="btn-chatgpt" style="background: #2196f3;">';
            helpHtml += '📖 מילון מורפיקס';
            helpHtml += '</a>';
            
            // האקדמיה ללשון העברית
            helpHtml += '<a href="https://hebrew-academy.org.il/" target="_blank" class="btn-chatgpt" style="background: #6f42c1;">';
            helpHtml += '🎓 האקדמיה ללשון';
            helpHtml += '</a>';
            
            // מבדק כתיב
            helpHtml += '<a href="https://www.mivdak.co.il/" target="_blank" class="btn-chatgpt" style="background: #ff9800;">';
            helpHtml += '✅ מבדק כתיב';
            helpHtml += '</a>';
            
            // צ'אט GPT עם השגיאות
            const wordsForQuery = uniqueWords.slice(0, 8).join(', ');
            const chatGPTQuery = encodeURIComponent('שלום! בינה מלאכותית זיהתה שגיאות כתיב בטקסט שלי במילים: ' + wordsForQuery + '. אתה יכול להסביר לי איך כותבים נכון כל מילה ומה החוק הדקדוקי? תודה!');
            const chatGPTUrl = 'https://chat.openai.com/?q=' + chatGPTQuery;
            
            helpHtml += '<a href="' + chatGPTUrl + '" target="_blank" class="btn-chatgpt">';
            helpHtml += '🤖 שאל צ\'אט GPT';
            helpHtml += '</a>';
            
            helpHtml += '</div>';
            helpHtml += '</div>';
            
            // הדגשת חשיבות התיקון
            helpHtml += '<div style="background: #f8d7da; padding: 15px; border-radius: 8px; margin: 15px 0; border: 2px solid #dc3545; text-align: center;">';
            helpHtml += '<h6 style="color: #721c24; margin-bottom: 10px;">⚠️ חשוב לתקן לפני המשך!</h6>';
            helpHtml += '<p style="color: #721c24; margin: 0;">המערכת לא תאפשר יצירת מתווה עד שכל שגיאות הכתיב יתוקנו</p>';
            helpHtml += '</div>';

            helpDiv.innerHTML = helpHtml;
            
            const activeCard = document.querySelector('.step-content.active .card');
            if (activeCard) {
                activeCard.appendChild(helpDiv);
            }
        }

        function checkSpellingSimple(text) {
            const errors = [];
            
            // מילון מורחב של שגיאות כתיב נפוצות מאוד שתלמידים עושים
            const commonErrors = {
                // שגיאות בסיסיות נפוצות
                'בעייה': 'בעיה',
                'בעיות': 'בעיות',
                'שיכבה': 'שכבה', 
                'הולכ': 'הולך',
                'זכרון': 'זיכרון',
                'זכרונות': 'זיכרונות',
                'איפוא': 'אפוא',
                'מכיון': 'מכיוון',
                'באו': 'בואו',
                
                // שגיאות בפעלים בזמן עבר
                'עשיתי': 'עשיתי', // נכון - לא שגיאה
                'אמרתי': 'אמרתי', // נכון - לא שגיאה
                'הלכתי': 'הלכתי', // נכון - לא שגיאה
                'ראיתי': 'ראיתי', // נכון - לא שגיאה
                'שמעתי': 'שמעתי', // נכון - לא שגיאה
                'למדתי': 'למדתי', // נכון - לא שגיאה
                'כתבתי': 'כתבתי', // נכון - לא שגיאה
                'קראתי': 'קראתי', // נכון - לא שגיאה
                
                // שגיאות אמיתיות בפעלים
                'עשיתי': 'עשיתי',
                'אמרתי': 'אמרתי', 
                'הלכתי': 'הלכתי',
                'ראיתי': 'ראיתי',
                'שמעתי': 'שמעתי',
                'למדתי': 'למדתי',
                'כתיבתי': 'כתבתי', // שגיאה - יותר מדי אותיות
                'קריאתי': 'קראתי', // שגיאה - יותר מדי אותיות
                'שמיעתי': 'שמעתי', // שגיאה - יותר מדי אותיות
                'למידתי': 'למדתי', // שגיאה - יותר מדי אותיות
                'הליכתי': 'הלכתי', // שגיאה - יותר מדי אותיות
                'ראיותי': 'ראיתי', // שגיאה - יותר מדי אותיות
                'שאלתי': 'שאלתי', // נכון
                'שאילתי': 'שאלתי', // שגיאה
                'ענתי': 'עניתי', // שגיאה - חסרות אותיות
                'עניתי': 'עניתי', // נכון
                'באתי': 'באתי', // נכון
                'יצאתי': 'יצאתי', // נכון
                'נכנסתי': 'נכנסתי', // נכון
                'ישבתי': 'ישבתי', // נכון
                'עמדתי': 'עמדתי', // נכון
                'רצתי': 'רצתי', // נכון
                'שיחקתי': 'שיחקתי', // נכון
                'עבדתי': 'עבדתי', // נכון
                'אהבתי': 'אהבתי', // נכון
                'שנאתי': 'שנאתי', // נכון
                'פחדתי': 'פחדתי', // נכון
                'שמחתי': 'שמחתי', // נכון
                'בכיתי': 'בכיתי', // נכון
                'צחקתי': 'צחקתי', // נכון
                'חשבתי': 'חשבתי', // נכון
                'זכרתי': 'זכרתי', // נכון
                'שכחתי': 'שכחתי', // נכון
                'הרגשתי': 'הרגשתי', // נכון
                'התחלתי': 'התחלתי', // נכון
                'סיימתי': 'סיימתי', // נכון
                'המשכתי': 'המשכתי', // נכון
                'עצרתי': 'עצרתי', // נכון
                'חזרתי': 'חזרתי', // נכון
                'הגעתי': 'הגעתי', // נכון
                'עזבתי': 'עזבתי', // נכון
                'נשארתי': 'נשארתי', // נכון
                'חיכיתי': 'חיכיתי', // נכון
                'קיוויתי': 'קיוויתי', // נכון
                'רציתי': 'רציתי', // נכון
                'יכולתי': 'יכולתי', // נכון
                'נתתי': 'נתתי', // נכון
                'לקחתי': 'לקחתי', // נכון
                'קניתי': 'קניתי', // נכון
                'מכרתי': 'מכרתי', // נכון
                'סיפרתי': 'סיפרתי', // נכון
                'התקשרתי': 'התקשרתי', // נכון
                'פגשתי': 'פגשתי', // נכון
                'ביקרתי': 'ביקרתי', // נכון
                'טיילתי': 'טיילתי', // נכון
                'נסעתי': 'נסעתי', // נכון
                
                // מילים בסיסיות ששגויות הרבה
                'חיי': 'חיי', // נכון
                'חיים': 'חיים', // נכון  
                'חייב': 'חייב', // נכון
                'חייבת': 'חייבת', // נכון
                'חייבים': 'חייבים', // נכון
                'חייבות': 'חייבות', // נכון
                'באמת': 'באמת', // נכון
                'למעשה': 'למעשה', // נכון
                'בעיקר': 'בעיקר', // נכון
                'בכלל': 'בכלל', // נכון
                'בגלל': 'בגלל', // נכון
                'חשוב': 'חשוב', // נכון
                'חשובה': 'חשובה', // נכון
                'חשובים': 'חשובים', // נכון
                'חשובות': 'חשובות', // נכון
                'יותר': 'יותר', // נכון
                'פחות': 'פחות', // נכון
                'הכי': 'הכי', // נכון
                'ביותר': 'ביותר', // נכון
                'מאוד': 'מאוד', // נכון
                'הרבה': 'הרבה', // נכון
                'מעט': 'מעט', // נכון
                'קצת': 'קצת', // נכון
                'די': 'די', // נכון
                'מדי': 'מדי', // נכון
                'כמעט': 'כמעט', // נכון
                'בדיוק': 'בדיוק', // נכון
                'ממש': 'ממש', // נכון
                'לגמרי': 'לגמרי', // נכון
                'אולי': 'אולי', // נכון
                'כנראה': 'כנראה', // נכון
                'בוודאי': 'בוודאי', // נכון
                'ודאי': 'ודאי', // נכון
                'בטח': 'בטח', // נכון
                'תמיד': 'תמיד', // נכון
                'לעולם': 'לעולם', // נכון
                'אף פעם': 'אף פעם', // נכון
                'פעם': 'פעם', // נכון
                'פעמים': 'פעמים', // נכון
                'לפעמים': 'לפעמים', // נכון
                'הפעם': 'הפעם', // נכון
                'יחד': 'יחד', // נכון
                'לבד': 'לבד', // נכון
                'ביחד': 'ביחד', // נכון
                
                // שגיאות נפוצות אמיתיות שתלמידים עושים
                'שיבה': 'שכבה', // שגיאה נפוצה
                'שיחבה': 'שכבה', // שגיאה נפוצה
                'בעיה': 'בעיה', // זה נכון - לא שגיאה!
                'זיכרון': 'זיכרון', // זה נכון - לא שגיאה!
                'אפוא': 'אפוא', // זה נכון - לא שגיאה!
                'מכיוון': 'מכיוון', // זה נכון - לא שגיאה!
                'בואו': 'בואו', // זה נכון - לא שגיאה!
                'הולך': 'הולך', // זה נכון - לא שגיאה!
                'שכבה': 'שכבה', // זה נכון - לא שגיאה!
            };

            // רק שגיאות אמיתיות - אני אכין מילון נפרד של שגיאות
            const realSpellingErrors = {
                'בעייה': 'בעיה',           // שגיאה אמיתית
                'שיכבה': 'שכבה',           // שגיאה אמיתית
                'שיבה': 'שכבה',            // שגיאה אמיתית
                'שיחבה': 'שכבה',           // שגיאה אמיתית
                'הולכ': 'הולך',            // שגיאה אמיתית
                'זכרון': 'זיכרון',          // שגיאה אמיתית
                'זכרונות': 'זיכרונות',      // שגיאה אמיתית
                'איפוא': 'אפוא',           // שגיאה אמיתית
                'מכיון': 'מכיוון',          // שגיאה אמיתית
                'באו': 'בואו',             // שגיאה אמיתית
                'כתיבתי': 'כתבתי',         // שגיאה אמיתית
                'קריאתי': 'קראתי',         // שגיאה אמיתית
                'שמיעתי': 'שמעתי',         // שגיאה אמיתית
                'למידתי': 'למדתי',         // שגיאה אמיתית
                'הליכתי': 'הלכתי',         // שגיאה אמיתית
                'ראיותי': 'ראיתי',         // שגיאה אמיתית
                'שאילתי': 'שאלתי',         // שגיאה אמיתית
                'ענתי': 'עניתי',           // שגיאה אמיתית
                'אירע': 'ארע',             // שגיאה אמיתית
                'אירעה': 'ארעה',           // שגיאה אמיתית
                'איחור': 'אחור',           // שגיאה אמיתית
                'איחוז': 'אחוז',           // שגיאה אמיתית
                'אימון': 'אמון',           // אם הכוונה לאמון - שגיאה
                'אירוח': 'ארוח',           // שגיאה אמיתית
                'אישור': 'אשור',           // אם הכוונה לאשור - שגיאה
                'גבעה': 'גבעה',            // נכון
                'גיבעה': 'גבעה',           // שגיאה אמיתית
                'מילה': 'מילה',            // נכון
                'מיילה': 'מילה',           // שגיאה אמיתית
                'ליד': 'ליד',              // נכון
                'לייד': 'ליד',             // שגיאה אמיתית
                'שיר': 'שיר',              // נכון
                'שיירה': 'שירה',           // שגיאה אמיתית אם הכוונה לשירה
                'נסיעה': 'נסיעה',          // נכון
                'נסייעה': 'נסיעה',         // שגיאה אמיתית
                'חיבור': 'חיבור',          // נכון
                'חייבור': 'חיבור',         // שגיאה אמיתית
                'שיחה': 'שיחה',            // נכון
                'שייחה': 'שיחה',           // שגיאה אמיתית
                'ביקור': 'ביקור',          // נכון
                'בייקור': 'ביקור',         // שגיאה אמיתית
                'חנות': 'חנות',            // נכון
                'חיינות': 'חנות',          // שגיאה אמיתית
                'בקשה': 'בקשה',            // נכון
                'בקישה': 'בקשה',           // שגיאה אמיתית
                'מדע': 'מדע',              // נכון
                'מידע': 'מידע',            // נכון - אם זה מה שהתכוון
                'עולם': 'עולם',            // נכון
                'עיולם': 'עולם',           // שגיאה אמיתית
                'משפט': 'משפט',            // נכון
                'מישפט': 'משפט',           // שגיאה אמיתית
                'דבר': 'דבר',              // נכון
                'דיבר': 'דיבר',            // נכון אם זה פועל
                'דיבור': 'דיבור',          // נכון
                'דיבר': 'דיבר',            // נכון
                'איש': 'איש',              // נכון
                'אייש': 'איש',             // שגיאה אמיתית
                'אשה': 'אשה',              // נכון
                'אישה': 'אישה',            // נכון
                'איישה': 'אישה',           // שגיאה אמיתית
                'לימוד': 'לימוד',          // נכון
                'ליימוד': 'לימוד',         // שגיאה אמיתית
                'שיטה': 'שיטה',            // נכון
                'שייטה': 'שיטה',           // שגיאה אמיתית
                'בחירה': 'בחירה',          // נכון
                'בחיירה': 'בחירה',         // שגיאה אמיתית
                'קריאה': 'קריאה',          // נכון
                'קרייאה': 'קריאה',         // שגיאה אמיתית
                'כתיבה': 'כתיבה',          // נכון
                'כתיבה': 'כתיבה',          // נכון כבר
                'כתיבה': 'כתיבה',          // נכון כבר
                'כתיבה': 'כתיבה',          // נכון כבר
                'כתיבה': 'כתיבה',          // נכון כבר
                'כתיבה': 'כתיבה',          // נכון כבר
                'כתיבה': 'כתיבה',          // נכון כבר
                'כתיבה': 'כתיבה',          // נכון כבר
                'כתיבה': 'כתיבה',          // נכון כבר
                'כתיבה': 'כתיבה',          // נכון כבר
                'בית': 'בית',              // נכון
                'ביית': 'בית',             // שגיאה אמיתית
                'לבית': 'לבית',            // נכון
                'לביית': 'לבית',           // שגיאה אמיתית
                'קול': 'קול',              // נכון
                'קיול': 'קול',             // שגיאה אמיתית
                'יום': 'יום',              // נכון
                'ייום': 'יום',             // שגיאה אמיתית
                'לילה': 'לילה',            // נכון
                'לייל': 'ליל',             // שגיאה אמיתית אם הכוונה לליל
                'לילה': 'לילה',            // נכון כבר
                'עיניים': 'עיניים',        // נכון
                'עינייים': 'עיניים',       // שגיאה אמיתית
                'ידיים': 'ידיים',          // נכון
                'ידייים': 'ידיים',         // שגיאה אמיתית
                'רגליים': 'רגליים',        // נכון
                'רגלייים': 'רגליים',       // שגיאה אמיתית
            };

            // בדיקת שגיאות נפוצות
            Object.keys(realSpellingErrors).forEach(wrongWord => {
                const regex = new RegExp('\\b' + wrongWord + '\\b', 'gi');
                const matches = text.match(regex);
                if (matches) {
                    matches.forEach(() => {
                        errors.push({
                            word: wrongWord,
                            suggestion: realSpellingErrors[wrongWord],
                            type: 'שגיאת כתיב',
                            message: 'שגיאת כתיב נפוצה בעברית'
                        });
                    });
                }
            });

            // בדיקת חזרות מיותרות
            const words = text.split(/\s+/);
            for (let i = 0; i < words.length - 1; i++) {
                const cleanWord1 = words[i].replace(/[^\u0590-\u05FF\u0041-\u005A\u0061-\u007A]/g, '');
                const cleanWord2 = words[i + 1].replace(/[^\u0590-\u05FF\u0041-\u005A\u0061-\u007A]/g, '');
                
                if (cleanWord1.toLowerCase() === cleanWord2.toLowerCase() && cleanWord1.length > 2) {
                    errors.push({
                        word: 'חזרה על המילה "' + cleanWord1 + '"',
                        suggestion: 'הסר את החזרה המיותרת',
                        type: 'חזרה מיותרת',
                        message: 'מילה חוזרת פעמיים ברצף'
                    });
                }
            }

            // בדיקת מילים באנגלית
            const englishWords = text.match(/\b[a-zA-Z]{3,}\b/g);
            if (englishWords) {
                englishWords.forEach(word => {
                    errors.push({
                        word: word,
                        suggestion: 'השתמש במילה בעברית',
                        type: 'מילה באנגלית',
                        message: 'מילה באנגלית במקום עברית'
                    });
                });
            }

            return errors;
        }

        function showSpellingHelp(errorWords) {
            const helpDiv = document.createElement('div');
            helpDiv.id = 'errorDetails';
            helpDiv.className = 'chatgpt-redirect';
            
            let helpHtml = '<h4>💡 נמצאו שגיאות כתיב - בואו נתקן אותן!</h4>';
            helpHtml += '<p>זוהו שגיאות כתיב בטקסט. השתמש בכלים הבאים כדי ללמוד את הכתיב הנכון:</p>';
            
            helpHtml += '<div style="background: white; padding: 20px; border-radius: 10px; margin: 15px 0;">';
            helpHtml += '<h5 style="color: #dc3545; margin-bottom: 15px;">🔍 שגיאות שנמצאו:</h5>';
            
            const uniqueWords = [...new Set(errorWords.map(error => error.word))];
            uniqueWords.forEach((word) => {
                helpHtml += '<div class="word-error">';
                helpHtml += '<span class="error-word">❌ ' + word + '</span>';
                const suggestion = errorWords.find(e => e.word === word)?.suggestion || '';
                if (suggestion) {
                    helpHtml += '<span class="suggestion">➡️ ' + suggestion + '</span>';
                }
                helpHtml += '</div>';
            });
            
            helpHtml += '</div>';
            
            helpHtml += '<div style="text-align: center; margin: 20px 0;">';
            helpHtml += '<a href="https://www.morfix.co.il/" target="_blank" class="btn-chatgpt" style="background: #2196f3; margin: 5px;">📖 מילון מורפיקס</a>';
            helpHtml += '<a href="https://hebrew-academy.org.il/" target="_blank" class="btn-chatgpt" style="background: #6f42c1; margin: 5px;">🎓 האקדמיה ללשון</a>';
            
            const wordsForQuery = uniqueWords.slice(0, 5).join(', ');
            const chatGPTQuery = encodeURIComponent('שלום! יש לי שגיאות כתיב במילים: ' + wordsForQuery + '. איך כותבים נכון?');
            const chatGPTUrl = 'https://chat.openai.com/?q=' + chatGPTQuery;
            
            helpHtml += '<a href="' + chatGPTUrl + '" target="_blank" class="btn-chatgpt" style="margin: 5px;">🤖 צ\'אט GPT</a>';
            helpHtml += '</div>';

            helpDiv.innerHTML = helpHtml;
            
            const activeCard = document.querySelector('.step-content.active .card');
            if (activeCard) {
                activeCard.appendChild(helpDiv);
            }
        }

        function showMessage(message, type) {
            const existingMessages = document.querySelectorAll('.message');
            existingMessages.forEach(msg => msg.remove());

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            if (type === 'success') {
                messageDiv.style.cssText = 'background: #d4edda; border: 2px solid #28a745; color: #155724; padding: 15px; border-radius: 10px; margin: 15px 0; font-weight: bold; text-align: center;';
                messageDiv.innerHTML = '✅ ' + message;
            } else if (type === 'error') {
                messageDiv.style.cssText = 'background: #f8d7da; border: 2px solid #dc3545; color: #721c24; padding: 15px; border-radius: 10px; margin: 15px 0; font-weight: bold; text-align: center;';
                messageDiv.innerHTML = '⚠️ ' + message;
            } else if (type === 'info') {
                messageDiv.style.cssText = 'background: #d1ecf1; border: 2px solid #17a2b8; color: #0c5460; padding: 15px; border-radius: 10px; margin: 15px 0; font-weight: bold; text-align: center;';
                messageDiv.innerHTML = '💡 ' + message;
            }

            const activeCard = document.querySelector('.step-content.active .card');
            if (activeCard) {
                activeCard.insertBefore(messageDiv, activeCard.firstChild);
            }

            if (type !== 'error') {
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.remove();
                    }
                }, 5000);
            }
        }

        // טעינת הדף
        document.addEventListener('DOMContentLoaded', function() {
            console.log('דף נטען בהצלחה');
            
            const homepage = document.getElementById('homepage');
            if (homepage) {
                homepage.classList.add('active');
                console.log('דף הבית מוצג');
            }
            
            const buttons = document.querySelectorAll('.btn-primary, .back-btn');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });

            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.style.transform = 'scale(1.02)';
                    this.style.transition = 'all 0.3s ease';
                });

                input.addEventListener('blur', function() {
                    this.style.transform = 'scale(1)';
                });
            });
            
            const essayBoxes = document.querySelectorAll('.essay-type-box');
            console.log('נמצאו', essayBoxes.length, 'קוביות סוג חיבור');
            
            essayBoxes.forEach((box, index) => {
                box.addEventListener('click', function() {
                    console.log('נלחץ על קוביה', index);
                    const onclick = this.getAttribute('onclick');
                    if (onclick) {
                        console.log('מפעיל:', onclick);
                        try {
                            eval(onclick);
                        } catch (error) {
                            console.error('שגיאה בביצוע onclick:', error);
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>
